/*!
 * monte v0.0.8 (http://www.luisrosar.io/lab/monte)
 * Copyright 2014-2015 luis rosario {zapo}
 * Licensed under MIT (https://github.com/aztec8/monte/blob/master/LICENSE)
 */

!function(a,b,c,d){"use strict";b.monte={tag:"M O N T E",settings:{},modules:{},responses:{umbrella:["Cherrio, __name__, see you at..."],millenium_falcon:["That's no moon __name__, it's ...","Help us __name__, you're our only hope. Join the Rebel Alliance at..."],elevator:["Hang on __name__, we're going up! See you at ...","Hold on tight __name__, we're going up! See you at ..."]},center_content:function(c){var d=a(c),e=(a(b).height()-d.height())/2;d.css({"padding-top":e+"px","padding-bottom":e+"px"})},choose_ride:function(b,c,d){monte.settings.ride=a(d).data("ride"),a(b).foundation("reveal","close");var e=a(".ride-choice");e.length&&e.removeClass("ride-choice"),a(c).parent().addClass("ride-choice"),console.log(monte.settings),monte.confirmation_page()},init:function(){console.log(this.tag);for(var b in this.modules)this.modules[b].init();this.utils.smooth_scroll();new Konami(this.utils.konami);TweenMax.to("#choose-your-ride",.2,{height:0}),TweenMax.to("#confirmation",.2,{height:0}),a("#choose-mary-poppins").on("click",function(){monte.choose_ride("#mary-poppins-modal",'[data-reveal-id="mary-poppins-modal"]',"#choose-mary-poppins")}),a("#choose-millenium-falcon").on("click",function(){monte.choose_ride("#millenium-falcon-modal",'[data-reveal-id="millenium-falcon-modal"]',"#choose-millenium-falcon")}),a("#choose-elevator").on("click",function(){monte.choose_ride("#elevator-modal",'[data-reveal-id="elevator-modal"]',"#choose-elevator")}),this.intro_page()},intro_page:function(){var b=new TimelineMax,c=new SplitText("#intro-text"),d=c.chars;TweenMax.set("#intro-text",{perspective:400}),b.from("#space-video",2.5,{opacity:0,delay:.25}).staggerFrom(d,.8,{opacity:0,scale:0,y:80,rotationX:180,transformOrigin:"0% 50% -50",ease:Back.easeOut,delay:"-=1"},.1,"+=0").from("#intro-text",1,{y:"85%"}).staggerFrom(".intro-text",2,{scale:.75,opacity:0,ease:Elastic.easeOut},.2),a("#intro-text").on("click",function(){b.restart()});var e=a("#main");e.css("position","fixed"),a("#rsvp-btn").on("click",function(){e.removeAttr("style"),monte.rsvp_form()})},rsvp_form:function(){this.center_content("#rsvp-form"),a("#name").focus(),a("#name").on("change",function(){monte.settings.name=a(this).val().split(" ")[0]}),a("#company").on("change",function(){monte.settings.company=a(this).val()}),a("#email").on("change",function(){monte.settings.email=a(this).val()}),a("#choose-your-ride-btn").on("click",function(){""===monte.settings.name||"undefined"===monte.settings.name||monte.settings.name===d?alert("Please add your name"):monte.choose_your_ride()})},choose_your_ride:function(){TweenMax.to("#choose-your-ride",.2,{height:a(".how-will-you-get-there").height()+a(".choose-your-ride").height()})},confirmation_page:function(){function d(){h.render(i),requestAnimationFrame(d)}var e=this.responses[this.settings.ride];a("#thank-you-text").html(e[Math.floor(Math.random()*e.length)].replace("__name__",monte.settings.name)),TweenMax.to("#confirmation",.2,{height:a(b).height()}),TweenMax.to(b,3,{scrollTo:{y:a("#confirmation").offset().top},ease:Power2.easeOut,delay:.5});var f=!1;if(f){var g,h=PIXI.autoDetectRenderer(800,600,{transparent:!0,view:c.querySelector("#space-canvas")}),i=new PIXI.Container;g=Foundation.utils.is_small_only()?PIXI.Texture.fromImage("images/freedom.jpg"):PIXI.Texture.fromVideo("misc/space-loop.mp4");var j=new PIXI.Sprite(g);j.width=h.width,j.height=h.height,i.addChild(j),d()}},utils:{drupal_test:function(){var a=!1;return"undefined"!=typeof Drupal&&(a=!0),a},smooth_scroll:function(){a("a[href*=#]:not([href=#])").click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var b=a(this.hash);if(b=b.length?b:a("[name="+this.hash.slice(1)+"]"),b.length)return a("html,body").animate({scrollTop:b.offset().top},1e3),!1}})},konami:function(){var c="js/vendor/howler.min.js",e=["misc/internet.mp3","misc/mario.mp3","misc/seinfeld.mp3"];if(monte.settings.in_drupal_environment){for(var f=0;f<e.length;f++)e[f]=monte.settings.drupal_theme_path+e[f];c=monte.settings.drupal_theme_path+c}b.Howl===d?a.ajax({url:c,dataType:"script",success:function(){monte.sound=new Howl({urls:[e[Math.floor(Math.random()*e.length)]]}).play()}}):(monte.sound.unload(),monte.sound=new Howl({urls:[e[Math.floor(Math.random()*e.length)]]}).play())}}},a(c).ready(function(){a(c).foundation(),monte.init()})}($||jQuery,window,window.document);